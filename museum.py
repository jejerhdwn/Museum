# -*- coding: utf-8 -*-
"""Museum.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1eq3Md5Rn6Y9uAPGSl5zZ-n8-ycr-99dC
"""

import streamlit as st
import requests
import pandas as pd

# ğŸŒ¿ í˜ì´ì§€ ì„¤ì •
st.set_page_config(page_title="êµ­ë¦½ì¤‘ì•™ë°•ë¬¼ê´€ ìœ ë¬¼ API", page_icon="ğŸº", layout="centered")

st.title("ğŸº êµ­ë¦½ì¤‘ì•™ë°•ë¬¼ê´€ Open API")
st.caption("ê³µê³µë°ì´í„°í¬í„¸ì˜ ìœ ë¬¼ ì •ë³´ë¥¼ Open APIë¡œ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤. (API í‚¤ ë¶ˆí•„ìš”)")

# ğŸ”¹ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° URL (êµ­ë¦½ì¤‘ì•™ë°•ë¬¼ê´€ ì˜¤í”ˆ API)
# ì•„ë˜ëŠ” 'ë¬¸í™”ìœ ì‚° í‘œì¤€ë°ì´í„°'ì—ì„œ ê³µê°œëœ ìƒ˜í”Œ JSON ì£¼ì†Œ
url = "https://api.github.com/orgs/museum-governance/repos"  # ì˜ˆì‹œìš© URL, ë‚˜ì¤‘ì— êµì²´ ê°€ëŠ¥

# ì‹¤ì œ ê³µê³µë°ì´í„° API (ì˜ˆì‹œ: ë¬¸í™”ìœ ì‚° í‘œì¤€ë°ì´í„°)
# url = "https://api.odcloud.kr/api/15098955/v1/uddi:7077e7be-d174-4a9d-864f-0cf048875fe4?page=1&perPage=5"

if st.button("ìœ ë¬¼ ë¶ˆëŸ¬ì˜¤ê¸°"):
    response = requests.get(url)

    if response.status_code == 200:
        try:
            data = response.json()
            # êµ­ë¦½ì¤‘ì•™ë°•ë¬¼ê´€ ë°ì´í„° êµ¬ì¡°ì— ë§ì¶° ì²˜ë¦¬
            if isinstance(data, dict) and "data" in data:
                records = data["data"]
            elif isinstance(data, list):
                records = data
            else:
                st.warning("ë°ì´í„° êµ¬ì¡°ë¥¼ ì¸ì‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
                st.json(data)
                st.stop()

            # DataFrameìœ¼ë¡œ ë³€í™˜
            df = pd.DataFrame(records)
            st.success(f"âœ… {len(df)}ê°œì˜ ìœ ë¬¼ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.")
            st.dataframe(df.head())

            # ì˜ˆì‹œ ì»¬ëŸ¼ì´ ìˆì„ ê²½ìš° ì‹œê°í™”
            if "title" in df.columns:
                st.subheader("ğŸ¨ ëŒ€í‘œ ìœ ë¬¼ ëª©ë¡")
                for i, row in df.head(5).iterrows():
                    st.write(f"**{row['title']}**")

        except Exception as e:
            st.error(f"ë°ì´í„° ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {e}")
    else:
        st.error(f"âŒ ìš”ì²­ ì‹¤íŒ¨: {response.status_code}")